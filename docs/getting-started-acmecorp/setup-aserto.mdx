---
sidebar_label: Set up an application with Aserto Authorization
---

# Set up an application with Aserto authorization

## Log in

Go to console.aserto.com and complete the Sign Up experience.

:::caution Note
TODO: update when signup experience is complete
:::

## Create your tenant

Once you have an account, you will be asked to create a tenant:

![create-tenant](/getting-started-acmecorp/choose-tenant-name.png)

When you’ve selected a tenant name, you’ll find yourself on the Policies page, ready to add your first Policy.

## Create a Policy

The underpinning of Aserto's authorization model is a policy. Policies are stored and versioned as OCI images in an OPCR repository. OPCR is an open source project (supported by Aserto) that allows developers to store and retrieve OPA policy bundles as OCI images.

### Sign up to OPCR.io

Open OPCR.io and click the Sign in button in the top right of the navbar, or go to console.openpolicyregistry.io, and create an opcr.io account with your GitHub account. This will trigger GitHub's OAuth2 flow.

![opcr-github](/getting-started-acmecorp/opcr-github.png)

:::note
Since OPCR uses GitHub as its identity provider, your account will be named after your GitHub account.
:::

#### Organizations

Much like with GitHub or Docker, an organization name provides the first part of a two-part name for a policy repository. For example, if your organization is named foo, you are able to create a repository named foo/bar.

#### Naming your personal organization

The first time through, you will be asked to name your organization. You can use your GitHub account name, or choose a different organization name that is unused, and passes the account naming conventions (4 or more characters, no profanity).

:::caution note
Choose your organization name carefully - you cannot change it later.
:::

![opcr-register](/getting-started-acmecorp/opcr-register.png)

## Add a connection to your OPCR organization

:::caution Note
--TBD
:::

## Choose a source code provider

:::caution Note
--TBD
:::

## Add a policy from a template

The user adds the peoplefinder-rbac policy to their tenant from the public repo

:::caution Note
--TBD
:::

Great! Your policy is now loaded. Next, we’re going to set up a sample application called “PeopleFinder” that will make use of this policy.

## Load the demo Acme Corp Users

We are going to load a set of users (272 to be exact) into your directory. Navigate to the “Connections” tab

![connections-tab](/getting-started-acmecorp/connections-tab.png)

and click “Add a connection”

![add-connection-button](/getting-started-acmecorp/add-connection-button.png)

Next, select the acmecorp provider:

![add-acmecorp-connections](/getting-started-acmecorp/add-acmecorp-connections.png)

Name the provider (you can choose whatever name you want) and give it a description.

Finally click “Add connection”

![add-connection-button](/getting-started-acmecorp/add-connection-button.png)

When a new connection to an identity provider is added, Aserto automatically imports the users from that identity provider into the Aserto Directory. The users loaded into the directory have different roles and attributes that will help us understand how authorization works. To see them, click on the users tab:

![users-tab](/getting-started-acmecorp/users-tab.png)

Use the directory filter to find the user “Euan Garden”:

![directory-filter](/getting-started-acmecorp/directory-filter.png)

![euan-garden-card](/getting-started-acmecorp/euan-garden-card.png)

Click on the user card and examine the JSON object (shortened here for brevity):

```
{
  "id": "cirkzmrhzgmzos03mzm1ltqwngqtywy2ni1jnzdjzjezyte1zjgsbwxvy2fs",
  "display_name": "Euan Garden",
  ...
  "identities": {
    ...
  },
  "attributes": {
    "properties": {
      "department": "Sales Engagement Management",
      "manager": "2bfaa552-d9a5-41e9-a6c3-5be62b4433c8",
      "phone": "+1-804-555-3383",
      "title": "Salesperson"
    },
    "roles": [
      "acmecorp",
      "sales-engagement-management",
      "user",
      "viewer"
    ],
    "permissions": []
  },
  "applications": {},
  "metadata": {
    "created_at": "2021-11-08T21:16:13.883383606Z",
    "updated_at": "2021-11-08T21:16:13.883383606Z",
    "deleted_at": null
  },
  "deleted": false
}

```

As you can see here, Euan has the role of a `viewer` (among others), and he is a member of the “Sales Engagement Management” department. Let’s look at another user: go back to the Directory and search for the user Kris Johnsen.

```
{
  "id": "cirknjriodq3ni0zyzvmltrjywytywy2zi05ytbmmwm1mwqxowysbwxvy2fs",
  "display_name": "Kris Johnsen",
  ...
  "identities": {
    ...
  },
  "attributes": {
    "properties": {
      "department": "Operations",
      "manager": "a528dc1d-0042-484d-81cb-dc58c95d8147",
      "phone": "+1-206-555-9001",
      "title": "IT Manager"
    },
    "roles": [
      "acmecorp",
      "admin",
      "operations",
      "user"
    ],
    "permissions": []
  },
  "applications": {},
  "metadata": {
    "created_at": "2021-11-09T11:16:16.289969130Z",
    "updated_at": "2021-11-09T11:16:16.289969130Z",
    "deleted_at": null
  },
  "deleted": false
}
```

Kris has the _role_ of `admin` (among others) and she is a member of the Operations department. Information in the user object is made available to the policies used by the Aserto authorizer at runtime to make a decision as to whether a user has access to a resource or not. Later in this tutorial we’ll see how to reference the user object in our policies.

## Deploy the PeopleFinder sample to Netlify

Bring up the [peoplefinder sample application repo on GitHub](https://github.com/aserto-dev/peoplefinder-acmecorp), and click the “Deploy to Netlify” button to initiate the deployment to your Netlify account (if you don’t have one, you’ll be prompted to create one - it’s free and awesome!)

![deploy-to-netlify](/getting-started-acmecorp/deploy-to-netlify.png)

You should see a screen like the following, which asks you to connect to your GitHub:

![netlify-connect-github](/getting-started-acmecorp/netlify-connect-github.png)

Once you complete the OAuth2 flow and authorize Netlify, you’ll be able to configure your PeopleFinder Netlify site by copying the values from the PeopleFinder policy configuration screen:

**TODO: Update configuration screenshot**

## Exploring PeopleFinder

Click on the Login button and sign in with euang@acmecorp.com - the password is V@rySecr#et321!.

![login-screen](/getting-started-acmecorp/login-screen.png)

The users loaded into your directory have attributes like manager and department, which the PeopleFinder application relies on, and are used in the authorization policies.

![users-list](/getting-started-acmecorp/users-list.png)

The policies used by this app dictate that people with the role of `viewer`, `editor` or `admin` are allowed to access and view the list of all users in the directory. They also govern who may make changes to a user’s contact information.
Since you’re logged in as Euan who is a `viewer`, the list of people is visible to you. Let’s click on the first user (Karin Lamb):

![karin-lamb-default](/getting-started-acmecorp/karin-lamb-default.png)

Click on “Edit” and try to modify and save the phone number for this user.

![karin-lamb-edit](/getting-started-acmecorp/karin-lamb-edit.png)

Once you save, you’ll run into the error:

![peoplefinder-error](/getting-started-acmecorp/peoplefinder-error.png)

This means that the current user (Euan) with the role of `viewer` is not allowed to edit other users. Navigate back to the People directory and open Euan’s user. If you try and edit this user the operation will succeed - later we’ll see how the access policy is defined to achieve this behavior.
Now, use the account switcher (on the top right) and choose Kris. As we saw before, Kris has the role of `admin` and so has stronger editing privileges. When you attempt to edit any user’s phone number as Kris, the operation will be permitted.

## Summary

That’s it! You loaded a set of demo users into your directory, and you now have an application which is communicating with the Aserto hosted authorizer. The authorizer is making decisions about which of the application routes users are allowed to interact with, as well as what content would be visible and enabled for them.
This simple example showcases the essence of the role-based access control (RBAC) model: a user is assigned a role which in turn is associated with a set of permissions that dictate the resources the user may access. In the next part of this tutorial we’ll go deeper into Aserto’s policies to understand how they are constructed.
